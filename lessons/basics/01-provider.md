# ๐ง ะฃัะพะบ 01: Provider

[โ ะะตัะฝััััั ะบ ะพัะฝะพะฒะฝะพะผั README](../../README.md)

## ๐ ะะะะะงะ

ะะฐััะธัััั ะฟะพะดะบะปััะฐัััั ะบ ะฑะปะพะบัะตะนะฝ-ะฟัะพะฒะฐะนะดะตัั ัะตัะตะท **Ethers.js** ะธ ะฟะพะฝััั, ะบะฐะบ ััััะพะตะฝะพ ะฒะทะฐะธะผะพะดะตะนััะฒะธะต ั Ethereum ะฝะฐ ะฝะธะทะบะพะผ ััะพะฒะฝะต.

---

## ๐ ะงัะพ ัะฐะบะพะต Provider?

**Provider** - ะผะพัั ะผะตะถะดั ัะฒะพะธะผ ะฟัะธะปะพะถะตะฝะธะตะผ ะธ ะฑะปะพะบัะตะนะฝะพะผ. ะะฝ ะฟะพะทะฒะพะปัะตั:

- ัะธัะฐัั ะดะฐะฝะฝัะต ะธะท ะฑะปะพะบัะตะนะฝะฐ (ะฑะฐะปะฐะฝัั, ะฑะปะพะบะธ, ัะพะฑััะธั)
- ะฟะพะดะฟะธััะฒะฐัััั ะฝะฐ ะพะฑะฝะพะฒะปะตะฝะธั
- ะพัะฟัะฐะฒะปััั ััะฐะฝะทะฐะบัะธะธ (ะฒ ัะฒัะทะบะต ั Wallet)

ะ Ethers.js ะธัะฟะพะปัะทัะตััั ะบะปะฐัั `ethers.JsonRpcProvider` ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ Ethereum ัะตัะตะท RPC (Remote Procedure Call).

---

## ๐ฆ ะขะธะฟั ะฟัะพะฒะฐะนะดะตัะพะฒ ะฒ Ethers.js (v6, 2025)

| ะขะธะฟ ะฟัะพะฒะฐะนะดะตัะฐ       | ะะฟะธัะฐะฝะธะต                                                                                |
| -------------------- | --------------------------------------------------------------------------------------- |
| `JsonRpcProvider`    | ะกัะฐะฝะดะฐััะฝัะน RPC-ะฟัะพะฒะฐะนะดะตั. ะะพะดะบะปััะฐะตััั ะบ Infura, Alchemy, ะปะพะบะฐะปัะฝะพะผั ัะทะปั ะธ ะดั.        |
| `WebSocketProvider`  | ะะพะดะบะปััะตะฝะธะต ัะตัะตะท WebSocket. ะะพะดัะพะดะธั ะดะปั ะฟะพะดะฟะธัะพะบ ะฝะฐ ัะพะฑััะธั ะบะพะฝััะฐะบัะพะฒ.               |
| `InfuraProvider`     | ะฃะฟัะพััะฝะฝะพะต ะฟะพะดะบะปััะตะฝะธะต ะบ Infura. ะขัะตะฑัะตััั `projectId` ะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ) `projectSecret`. |
| `AlchemyProvider`    | ะััััะฐั ะธะฝัะตะณัะฐัะธั ั Alchemy. ะะฝะฐะปะพะณะธัะฝะพ InfuraProvider.                                |
| `CloudflareProvider` | ะะตัะฟะปะฐัะฝัะน ะฟัะพะฒะฐะนะดะตั **ัะพะปัะบะพ ะดะปั Ethereum mainnet**. ะะตะท API ะบะปััะฐ.                    |
| `FallbackProvider`   | ะะฑัะตะดะธะฝัะตั ะฝะตัะบะพะปัะบะพ ะฟัะพะฒะฐะนะดะตัะพะฒ ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะฟะตัะตะบะปััะตะฝะธะตะผ ะฟัะธ ัะฑะพะต.               |
| `AnkrProvider`       | ะัะฑะปะธัะฝัะน ะฟัะพะฒะฐะนะดะตั ะพั Ankr. ะะต ััะตะฑัะตั ะบะปััะฐ. ะะพะดัะพะดะธั ะดะปั ะฑััััะพะณะพ ััะฐััะฐ.            |

---

### โ๏ธ ะะพะฟะพะปะฝะธัะตะปัะฝะพ

- ะ Ethers.js v6 ะธัะฟะพะปัะทัะตััั ะผะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ: ะผะพะถะฝะพ ะฟะพะดะบะปััะฐัั ััะฐะฝัะฟะพััั ะพัะดะตะปัะฝะพ (`ethers.InfuraTransport`, `ethers.JsonRpcProvider` ะธ ั.ะด.).
- ะะปั ะฑะพะปััะธะฝััะฒะฐ ะทะฐะดะฐั ะฟะพะดะพะนะดัั `ethers.getDefaultProvider(network)` โ ะพะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธัะฟะพะปัะทัะตั FallbackProvider ั ะฝะตัะบะพะปัะบะธะผะธ ะฟัะพะฒะฐะนะดะตัะฐะผะธ.
- `FallbackProvider` ะฟะพะทะฒะพะปัะตั ะทะฐะดะฐะฒะฐัั ะฒะตัะฐ ะธ ัะฐะนะผะฐััั ะดะปั ะฝะฐะดัะถะฝะพััะธ.

---

๐ ะะพะบัะผะตะฝัะฐัะธั: [https://docs.ethers.org/v6/](https://docs.ethers.org/v6/)

## ๐ง ะะฐะบ ะฒัะฑัะฐัั RPC-ะฟัะพะฒะฐะนะดะตัะฐ?

- **Infura** โ ัะดะพะฑะฝะพ, ััะฐะฑะธะปัะฝะพ, ะฑะตัะฟะปะฐัะฝะพ ะดะพ ะปะธะผะธัะฐ
- **Alchemy** โ ะผะพัะฝัะต DevTools + ัะพัะพัะธะต ะปะธะผะธัั
- **QuickNode** โ ะฑัััััะน, ะฝะพ ะฟะปะฐัะฝัะน
- **Local RPC** โ ะตัะปะธ ัะฐะทะฒะพัะฐัะธะฒะฐะตัั ะฝะพะดั ัะฐะผ (`geth`, `anvil`, `hardhat`)

---

## ๐งญ ะงะฐัััะต ะพัะธะฑะบะธ ะฟัะธ ัะฐะฑะพัะต ั ะฟัะพะฒะฐะนะดะตัะฐะผะธ

| ะัะธะฑะบะฐ                                | ะัะธัะธะฝะฐ ะธ ัะตัะตะฝะธะต                                                            |
| ------------------------------------- | ---------------------------------------------------------------------------- |
| `Missing API key` ะธะปะธ `403 Forbidden` | ะะตะฒะตัะฝัะน ะธะปะธ ะพััััััะฒัััะธะน API ะบะปัั. ะัะพะฒะตัั `.env` ะธ URL                    |
| `Cannot read properties of undefined` | ะะฐะฑัะป `dotenv.config()` ะธะปะธ ะฟะตัะตะผะตะฝะฝะฐั ะพะบััะถะตะฝะธั ะฟัััะฐั                      |
| `Network Error` ะธะปะธ `ECONNREFUSED`    | RPC-ัะตัะฒะตั ะฝะต ะพัะฒะตัะฐะตั. ะัะพะฒะตัั URL ะธะปะธ ะทะฐะผะตะฝะธ ะฝะฐ ะดััะณะพะณะพ ะฟัะพะฒะฐะนะดะตัะฐ         |
| `Timeout exceeded`                    | ะะตััะฐะฑะธะปัะฝะพะต ัะพะตะดะธะฝะตะฝะธะต. ะัะฟะพะปัะทัะน `FallbackProvider` ะดะปั ะพัะบะฐะทะพัััะพะนัะธะฒะพััะธ |

---

## ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะฐััะธัะตะบัััะต

- ะฅัะฐะฝะธัั RPC-ะบะปััะธ ะพัะดะตะปัะฝะพ ะฒ `.env`, ะฝะธะบะพะณะดะฐ ะฝะต ะบะพะผะธัั ะธั ะฒ Git
- ะัะดะตะปะธัั `provider.ts` ะบะฐะบ ะผะพะดัะปั ั ะบะพะฝัะธะณััะฐัะธะตะน (ะพัะพะฑะตะฝะฝะพ ะตัะปะธ ั ัะตะฑั ะฝะตัะบะพะปัะบะพ ัะตัะตะน)
- ะัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ ะฟะพะดะฟะธัะพะบ ะธัะฟะพะปัะทะพะฒะฐัั WebSocket-ะฟัะพะฒะฐะนะดะตั ะพัะดะตะปัะฝะพ ะพั JsonRpc
- ะัะปะธ ะฟะธัะฐัั ะฑะพัะฐ - ะธัะฟะพะปัะทัะตะผ `FallbackProvider` ั ะฝะตัะบะพะปัะบะธะผะธ ะธััะพัะฝะธะบะฐะผะธ

## ๐งฐ ะงัะพ ะผะพะถะฝะพ ะดะตะปะฐัั ั ะฟัะพะฒะฐะนะดะตัะพะผ?

```ts
// ะะฐะทะพะฒัะต ะผะตัะพะดั:
await provider.getBlockNumber(); // ัะตะบััะธะน ะฝะพะผะตั ะฑะปะพะบะฐ
await provider.getNetwork(); // ะธะฝัะพัะผะฐัะธั ะพ ัะตัะธ
await provider.getBalance(address); // ะฑะฐะปะฐะฝั ะฒ wei
await provider.getGasPrice(); // ัะตะฝะฐ ะณะฐะทะฐ
await provider.getBlock("latest"); // ะดะฐะฝะฝัะต ะฟะพัะปะตะดะฝะตะณะพ ะฑะปะพะบะฐ
await provider.getTransaction(hash); // ะธะฝัะพัะผะฐัะธั ะพ ััะฐะฝะทะฐะบัะธะธ
await provider.getLogs(filter); // ัะธะปัััะฐัะธั ัะพะฑััะธะน
```

### ๐งช ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฟัะพะฒะฐะนะดะตัะฐ

```ts
import { JsonRpcProvider } from "ethers";

const provider = new JsonRpcProvider("https://mainnet.infura.io/v3/INFURA_KEY");

const main = async () => {
  const blockNumber = await provider.getBlockNumber();
  console.log("ะขะตะบััะธะน ะฝะพะผะตั ะฑะปะพะบะฐ:", blockNumber);
};

main();
```

## ๐ ะัะธะผะตั ะฒะธะทัะฐะปัะฝะพะณะพ ะฟะพัะพะบะฐ provider

                โโโโโโโโโโโโโโโโ
                โ   ะัะพะณัะฐะผะผะฐ  โ
                โโโโโโโโฌโโโโโโโโ
                       โ ะฒัะทะพะฒ ะผะตัะพะดะฐ (ะฝะฐะฟัะธะผะตั, getBalance)
                       โผ
                โโโโโโโโโโโโโโโโ
                โ   Provider   โ  (ethers.js)
                โโโโโโโโฌโโโโโโโโ
                       โ ัะพัะผะธััะตั JSON-RPC
                       โผ
             โโโโโโโโโโโโโโโโโโโโโโโ
             โ Ethereum-ะฝะพะดะฐ (RPC) โ โ Infura / Alchemy / Hardhat / Geth
             โโโโโโโโโโโโโโโโโโโโโโโ
                       โฒ
                       โ ะพัะฒะตั JSON
                       โผ
                โโโโโโโโโโโโโโโโ
                โ  Provider    โ
                โโโโโโโโฌโโโโโโโโ
                       โ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะฐ
                       โผ
                โโโโโโโโโโโโโโโโ
                โ   ะัะพะณัะฐะผะผะฐ  โ
                โโโโโโโโโโโโโโโโ

---

## ๐ ะงัะพ ะดะฐะปััะต?

ะผั ัะฐะทะพะฑัะฐะปะธ:

- ะงัะพ ัะฐะบะพะต ะฟัะพะฒะฐะนะดะตั ะธ ะทะฐัะตะผ ะพะฝ ะฝัะถะตะฝ
- ะะฐะบะธะต ัะธะฟั ะฟัะพะฒะฐะนะดะตัะพะฒ ะฑัะฒะฐัั ะฒ Ethers.js
- ะะฐะบ ะฒัะฑะธัะฐัั RPC ะธ ะฟะพะดะบะปััะฐัััั ะบ Ethereum
- ะะฐะบะธะต ะพัะธะฑะบะธ ะผะพะณัั ะฒะพะทะฝะธะบะฝััั ะธ ะบะฐะบ ะธั ะธะทะฑะตะณะฐัั
- ะะฐะทะพะฒัะต ะผะตัะพะดั ะดะปั ััะตะฝะธั ะดะฐะฝะฝัั ะธะท ะฑะปะพะบัะตะนะฝะฐ

---

## ๐งช ะะฐะปััะต - ัะตัะฝะธัะตัะบะธะน ัะฐะทะฑะพั

ะ ัะฐะนะปะต [`01-provider.ts`](./01-provider.ts) ะผั **ัะตัะฝะธัะตัะบะธ ัะฐะทะฑะตััะผ ัะฐะฑะพัั ะฟัะพะฒะฐะนะดะตัะฐ** ะธ ะฟะพัะฐะณะพะฒะพ ะฒัะฟะพะปะฝะธะผ:

1. ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะธ ัะตัะตะท `JsonRpcProvider`
2. ะะพะปััะตะฝะธะต ะฝะพะผะตัะฐ ะฑะปะพะบะฐ ะธ ะธะฝัะพัะผะฐัะธะธ ะพ ัะตัะธ
3. ะะพะปััะตะฝะธะต ัะตะฝั ะณะฐะทะฐ
4. ะะพะปััะตะฝะธะต ะฑะฐะปะฐะฝัะฐ ะฐะดัะตัะฐ
5. ะัะฟะพะปัะทะพะฒะฐะฝะธะต `.env` ะธ ะฑะตะทะพะฟะฐัะฝะฐั ะบะพะฝัะธะณััะฐัะธั

ะญัะพ ะฑัะดะตั **ะฝะต ะฟะพะปะฝะพัะตะฝะฝะฐั ะฟัะฐะบัะธะบะฐ**, ะฐ **ัะฐะทะพะณัะตะฒ** ะธ ะฟะพะดะณะพัะพะฒะบะฐ ะบ ัะปะตะดัััะตะผั ััะพะบั, ะณะดะต ะผั ะฝะฐัะฝัะผ ะฒะทะฐะธะผะพะดะตะนััะฒะพะฒะฐัั ั ะบะพัะตะปัะบะฐะผะธ ะธ ััะฐะฝะทะฐะบัะธัะผะธ.

---
